<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Selecting the best group using the Indifferent-Zone approach for binomial outcomes • ssutil</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selecting the best group using the Indifferent-Zone approach for binomial outcomes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ssutil</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/equivalence.html">Equivalence Testing for Normal Outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/iz_binomial.html">Selecting the best group using the Indifferent-Zone approach for binomial outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/iz_normal.html">Selecting the best group using the Indifferent-Zone approach for normal outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/negative_binomial.html">Simulations for Negative Binomial outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/non_inferiority.html">Simulations for Non-inferiority trials</a></li>
    <li><a class="dropdown-item" href="../articles/power_single_rate.html">Detectable Event Rate for Safety Signal Detection: Using `power_single_rate`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selecting the best group using the Indifferent-Zone approach for binomial outcomes</h1>
            
      

      <div class="d-none name"><code>iz_binomial.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://johnaponte.github.io/ssutil/">ssutil</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The indifferent-zone approach for binomial outcomes is a statistical
method designed to select the group with the highest event probability
while ensuring that this selection is made correctly at a specified
confidence level. This approach assumes that the difference in event
probability between the best group and the next-best group exceeds a
specified threshold, called the “indifferent zone”. This zone defines a
margin of indifference, within which differences are considered
negligible, allowing the decision process to focus only on differences
that clearly exceed this margin.</p>
<p>This package offers several functions to help with this design:</p>
<p><code><a href="../reference/power_best_binomial.html">power_best_binomial()</a></code> calculates the exact probability
of correctly selecting the best group given the event probability in the
best group (<code>p1</code>), the pre-specified indifferent-zone
threshold (<code>dif</code>), the number of groups
(<code>ngroups</code>), and the sample size per group
(<code>npergroup</code>). This function is based on Sobel and Huyett
(1957) under the least favorable configuration (i.e., assuming all other
groups have an event probability equal to the best group’s probability
minus the indifferent-zone threshold).</p>
<p><code><a href="../reference/ss_best_binomial.html">ss_best_binomial()</a></code> estimates the required sample size
per group to achieve a specified power for correctly selecting the best
group, given the event probability in the best group (<code>p1</code>),
the indifferent-zone threshold (<code>dif</code>), and the number of
groups (<code>ngroups</code>).</p>
<p><code><a href="../reference/sim_power_best_binomial.html">sim_power_best_binomial()</a></code> estimates the empirical power
(i.e., the proportion of simulated trials in which the best group is
correctly identified) via Monte Carlo simulation. It supports multiple
outcomes and can estimate the empirical power to select the true best
group across all outcomes.</p>
<p><code><a href="../reference/sim_power_best_bin_rank.html">sim_power_best_bin_rank()</a></code> is similar to
<code><a href="../reference/sim_power_best_binomial.html">sim_power_best_binomial()</a></code>, but it defines the best group
based on overall ranking across multiple outcomes rather than requiring
top performance on every outcome.</p>
<p><code><a href="../reference/wcs_power_best_binomial.html">wcs_power_best_binomial()</a></code> searches for the probability
in the best group that leads to the lowest power given a pre-specified
indifferent-zone threshold (<code>dif</code>), the number of groups
(<code>ngroups</code>), and the sample size per group
(<code>npergroup</code>)</p>
</div>
<div class="section level2">
<h2 id="examples-with-a-single-outcome">Examples with a single outcome<a class="anchor" aria-label="anchor" href="#examples-with-a-single-outcome"></a>
</h2>
<ol style="list-style-type: decimal">
<li>What is the probability of correctly selecting the best group in a
trial with three groups of 30 participants each? Assume the best group
has an event probability of 90% and the indifferent-zone threshold is
10%.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/power_best_binomial.html">power_best_binomial</a></span><span class="op">(</span>p1 <span class="op">=</span> <span class="fl">0.9</span>, dif <span class="op">=</span> <span class="fl">0.1</span>, ngroups <span class="op">=</span> <span class="fl">3</span>, npergroup <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7584432</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>What is the sample size required per group to achieve 90% power for
correctly selecting the best group among three groups, assuming the best
group has an event probability of 90% and the indifferent-zone threshold
is 10%.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ss_best_binomial.html">ss_best_binomial</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">0.9</span>, p1 <span class="op">=</span> <span class="fl">0.9</span>, dif <span class="op">=</span> <span class="fl">0.1</span>, ngroups <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 64</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Using simulations, what is the probability of correctly selecting
the best group in a trial with three groups of 30 participants each?
Assume the best group has an event probability of 90% and the
indifferent-zone threshold is 10%.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sim_power_best_binomial.html">sim_power_best_binomial</a></span><span class="op">(</span></span>
<span>  noutcomes <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  dif <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  ngroups <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  npergroup <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Empirical Power Result</span></span>
<span><span class="co">#&gt; ----------------------- </span></span>
<span><span class="co">#&gt; Power:       0.7740</span></span>
<span><span class="co">#&gt; 95% CI:      [0.7468, 0.7996]</span></span>
<span><span class="co">#&gt; Simulations: 1000</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>What is the lowest power in a study where the indifference-zone is
setup to 10%, there are 3 groups and 50 participants per group?</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wcs_power_best_binomial.html">wcs_power_best_binomial</a></span><span class="op">(</span>dif <span class="op">=</span> <span class="fl">0.1</span>, ngroups <span class="op">=</span> <span class="fl">3</span>, npergroup <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt; $p1</span></span>
<span><span class="co">#&gt; [1] 0.5541703</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $minimum_power</span></span>
<span><span class="co">#&gt; [1] 0.7410576</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples-using-multiple-outcomes">Examples using multiple outcomes<a class="anchor" aria-label="anchor" href="#examples-using-multiple-outcomes"></a>
</h2>
<p>The <code><a href="../reference/sim_power_best_binomial.html">sim_power_best_binomial()</a></code> and
<code><a href="../reference/sim_power_best_bin_rank.html">sim_power_best_bin_rank()</a></code> allow simulating multiple
outcomes. These functions differ in how they define the ‘best’ group.
<code><a href="../reference/sim_power_best_binomial.html">sim_power_best_binomial()</a></code> requires that the best group be
the top performer for every outcome, whereas
<code><a href="../reference/sim_power_best_bin_rank.html">sim_power_best_bin_rank()</a></code> defines the best group based on
overall ranking across outcomes. For example, a group might rank first
for the first two outcomes but second for the third, yet still achieve
the best overall rank among all groups.</p>
<p>This ranking approach supports weighting of outcomes, allowing
greater importance to be assigned to some outcomes over others. For
instance, if performance on the first two outcomes is twice as important
as the third, weights such as <code>c(0.4, 0.4, 0.2)</code> can be
specified. Weights are scaled internally to sum 1.</p>
<p>The functions are flexible and allow specification of, for each
outcome, the event probabilities, indifferent-zone thresholds, and group
sample sizes.</p>
<ol style="list-style-type: decimal">
<li>What is the probability that the best group is correctly identified
as having the highest seroconversion rate across five antigens in a
trial with three groups of 30 participants each? Assume the best group’s
seroconversion rate is 80% and the indifferent-zone threshold is 10% for
all outcomes.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sim_power_best_binomial.html">sim_power_best_binomial</a></span><span class="op">(</span></span>
<span>  noutcomes <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  dif <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>  ngroups <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  npergroup <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Empirical Power Result</span></span>
<span><span class="co">#&gt; ----------------------- </span></span>
<span><span class="co">#&gt; Power:       0.1670</span></span>
<span><span class="co">#&gt; 95% CI:      [0.1444, 0.1916]</span></span>
<span><span class="co">#&gt; Simulations: 1000</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Same setup, but define the best group based on overall ranking
across the five outcomes with equal weights.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/sim_power_best_bin_rank.html">sim_power_best_bin_rank</a></span><span class="op">(</span></span>
<span>  noutcomes <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  p1 <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  dif <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>  weights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ngroups <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  npergroup <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Empirical Power Result</span></span>
<span><span class="co">#&gt; ----------------------- </span></span>
<span><span class="co">#&gt; Power:       0.9190</span></span>
<span><span class="co">#&gt; 95% CI:      [0.9003, 0.9352]</span></span>
<span><span class="co">#&gt; Simulations: 1000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Sobel, M., &amp; Huyett, M. J. (1957). Selecting the Best One of
Several Binomial Populations. Bell System Technical Journal, 36(2),
537-576. <a href="https://doi.org/10.1002/j.1538-7305.1957.tb02411.x" class="external-link uri">https://doi.org/10.1002/j.1538-7305.1957.tb02411.x</a></p>
<p>Bechhofer, R. E., Santner, T. J., &amp; Goldsman, D. M. (1995).
Design and analysis of experiments for statistical selection, screening,
and multiple comparisons. Wiley. ISBN 978-0-471-57427-9</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John J. Aponte.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
